(* Generated by coq-of-rust *)
Require Import CoqOfRust.CoqOfRust.

Definition NTHREADS (_ : unit) := 10.

Definition main (_ : unit) :=
  let children := _crate::vec::ImplVec.new tt in
  match into_iter {| Range.start := 0; Range.end := NTHREADS; |} with
  | iter =>
    loop
      match next iter with
      | {|  |} => Break
      | {| Some.0 := i; |} =>
        method
          "push"
          children
          (thread.spawn
            (fun  =>
              _crate.io._print
                (_crate::fmt::ImplArguments.new_v1
                  ["this is thread number ";"\n"]
                  [_crate::fmt::ImplArgumentV1.new_display i]) ;;
              tt ;;
              tt)) ;;
        tt
      end ;;
      tt
      from
      for
  end ;;
  match into_iter children with
  | iter =>
    loop
      match next iter with
      | {|  |} => Break
      | {| Some.0 := child; |} =>
        let _ := method "join" child in
        tt
      end ;;
      tt
      from
      for
  end.
